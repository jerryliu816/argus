<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Robot Control Dashboard</title>
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="manifest" href="/static/manifest.json">
    <meta name="theme-color" content="#2196F3">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>ü§ñ Robot Control Dashboard</h1>
            <div class="status-bar">
                <div class="status-item">
                    <span class="status-label">Connection:</span>
                    <span id="connection-status" class="status-value disconnected">Disconnected</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Robot:</span>
                    <span id="robot-status" class="status-value unknown">Unknown</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Camera:</span>
                    <span id="camera-status" class="status-value unknown">Unknown</span>
                </div>
            </div>
        </header>

        <!-- Emergency Stop -->
        <div class="emergency-stop">
            <button id="emergency-stop" class="emergency-btn">üõë EMERGENCY STOP</button>
        </div>

        <!-- Main Control Area -->
        <div class="main-controls">
            <!-- Left Side - Movement Controls -->
            <div class="control-panel">
                <h2>Movement Control</h2>
                
                <!-- Device Type Indicator -->
                <div class="device-indicator">
                    <span id="device-type">Detecting input device...</span>
                </div>

                <!-- KEYBOARD CONTROLS REMOVED - USING TOUCH ONLY -->

                <!-- Touch Controls - ALWAYS VISIBLE -->
                <div id="touch-controls" class="touch-section" style="display: block !important;">
                    <div class="joystick-container">
                        <div id="joystick" class="joystick">
                            <div id="joystick-knob" class="joystick-knob"></div>
                        </div>
                        <div class="joystick-label">Virtual Joystick</div>
                    </div>
                </div>

                <!-- Speed Controls -->
                <div class="speed-controls">
                    <h3>Speed Settings</h3>
                    <div class="speed-sliders">
                        <div class="slider-group">
                            <label for="linear-speed">Linear Speed:</label>
                            <input type="range" id="linear-speed" min="0.1" max="2.0" step="0.1" value="0.5">
                            <span id="linear-speed-value">0.5 m/s</span>
                        </div>
                        <div class="slider-group">
                            <label for="angular-speed">Angular Speed:</label>
                            <input type="range" id="angular-speed" min="0.1" max="3.0" step="0.1" value="1.0">
                            <span id="angular-speed-value">1.0 rad/s</span>
                        </div>
                    </div>
                </div>

                <!-- Dock Controls -->
                <div class="dock-controls">
                    <button id="dock-btn" class="dock-btn">üö™ Dock</button>
                    <button id="undock-btn" class="undock-btn">üèÉ Undock</button>
                </div>
            </div>

            <!-- Right Side - Camera and Status -->
            <div class="info-panel">
                <h2>Camera Feed</h2>
                
                <!-- Camera Preview -->
                <div class="camera-section">
                    <div class="camera-preview" id="camera-preview">
                        <img id="camera-thumbnail" src="" alt="Camera feed" class="camera-img">
                        <div class="camera-overlay">
                            <button id="camera-refresh" class="camera-btn">üîÑ Refresh</button>
                            <button id="camera-fullscreen" class="camera-btn">üîç Enlarge</button>
                        </div>
                        <div id="camera-loading" class="camera-loading hidden">Loading...</div>
                        <div id="camera-error" class="camera-error hidden">Camera not available</div>
                    </div>
                </div>

                <!-- Current Status -->
                <div class="status-section">
                    <h3>Current Status</h3>
                    <div class="status-grid">
                        <div class="status-row">
                            <span class="label">Linear Speed:</span>
                            <span id="current-linear">0.0 m/s</span>
                        </div>
                        <div class="status-row">
                            <span class="label">Angular Speed:</span>
                            <span id="current-angular">0.0 rad/s</span>
                        </div>
                        <div class="status-row">
                            <span class="label">Movement:</span>
                            <span id="current-movement">Stopped</span>
                        </div>
                        <div class="status-row">
                            <span class="label">Last Command:</span>
                            <span id="last-command">None</span>
                        </div>
                    </div>
                </div>

                <!-- Future Features -->
                <div class="future-features">
                    <h3>AI Analysis</h3>
                    <button id="analyze-btn" class="analyze-btn" disabled>üì∏ Capture & Analyze</button>
                    <p class="feature-note">Coming in Phase 3</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Camera Modal -->
    <div id="camera-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Camera View</h3>
                <button id="modal-close" class="modal-close">‚úï</button>
            </div>
            <div class="modal-body">
                <img id="camera-full" src="" alt="Full camera view" class="camera-full-img">
                <div class="modal-controls">
                    <button id="modal-refresh" class="camera-btn">üîÑ Refresh</button>
                    <button id="modal-download" class="camera-btn">üíæ Download</button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="/static/js/websocket.js"></script>
    <script src="/static/js/touch.js"></script>
    <script src="/static/js/camera.js"></script>
    <script src="/static/js/controls.js"></script>
</body>
</html>